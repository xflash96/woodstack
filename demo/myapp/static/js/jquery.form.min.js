(function(b){function o(a){var c=a.data;a.isDefaultPrevented()||(a.preventDefault(),b(this).ajaxSubmit(c))}function s(a){var c=a.target,g=b(c);if(!g.is(":submit,input:image")){c=g.closest(":submit");if(0===c.length)return;c=c[0]}var f=this;f.clk=c;"image"==c.type&&(void 0!==a.offsetX?(f.clk_x=a.offsetX,f.clk_y=a.offsetY):"function"==typeof b.fn.offset?(g=g.offset(),f.clk_x=a.pageX-g.left,f.clk_y=a.pageY-g.top):(f.clk_x=a.pageX-c.offsetLeft,f.clk_y=a.pageY-c.offsetTop));setTimeout(function(){f.clk=
f.clk_x=f.clk_y=null},100)}function p(){if(b.fn.ajaxSubmit.debug){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(a):window.opera&&window.opera.postError&&window.opera.postError(a)}}var t,u;t=void 0!==b("<input type='file'/>").get(0).files;u=void 0!==window.FormData;b.fn.ajaxSubmit=function(a){function c(c){for(var f=new FormData,e=0;e<c.length;e++)f.append(c[e].name,c[e].value);if(a.extraData)for(var g in a.extraData)a.extraData.hasOwnProperty(g)&&
f.append(g,a.extraData[g]);a.data=null;c=b.extend(!0,{},b.ajaxSettings,a,{contentType:!1,processData:!1,cache:!1,type:"POST"});a.uploadProgress&&(c.xhr=function(){var b=jQuery.ajaxSettings.xhr();b.upload&&(b.upload.onprogress=function(b){var c=0;b.lengthComputable&&(c=parseInt(100*(b.position/b.total),10));a.uploadProgress(b,b.position,b.total,c)});return b});c.data=null;var k=c.beforeSend;c.beforeSend=function(b,d){d.data=f;k&&k.call(d,b,a)};b.ajax(c)}function g(c){function e(){function a(){try{var b=
(m.contentWindow?m.contentWindow.document:m.contentDocument?m.contentDocument:m.document).readyState;p("state = "+b);b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(c){p("Server abort: ",c," (",c.name,")"),g(x),v&&clearTimeout(v),v=void 0}}var c=k.attr("target"),i=k.attr("action");j.setAttribute("target",o);f||j.setAttribute("method","POST");i!=d.url&&j.setAttribute("action",d.url);!d.skipEncodingOverride&&(!f||/post/i.test(f))&&k.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});
d.timeout&&(v=setTimeout(function(){s=!0;g(t)},d.timeout));var h=[];try{if(d.extraData)for(var l in d.extraData)d.extraData.hasOwnProperty(l)&&h.push(b('<input type="hidden" name="'+l+'">').attr("value",d.extraData[l]).appendTo(j)[0]);d.iframeTarget||(r.appendTo("body"),m.attachEvent?m.attachEvent("onload",g):m.addEventListener("load",g,!1));setTimeout(a,15);j.submit()}finally{j.setAttribute("action",i),c?j.setAttribute("target",c):k.removeAttr("target"),b(h).remove()}}function g(a){if(!i.aborted&&
!z){try{q=m.contentWindow?m.contentWindow.document:m.contentDocument?m.contentDocument:m.document}catch(c){p("cannot access response document: ",c),a=x}if(a===t&&i)i.abort("timeout");else if(a==x&&i)i.abort("server abort");else if(q&&q.location.href!=d.iframeSrc||s){m.detachEvent?m.detachEvent("onload",g):m.removeEventListener("load",g,!1);var a="success",e;try{if(s)throw"timeout";var f="xml"==d.dataType||q.XMLDocument||b.isXMLDoc(q);p("isXml="+f);if(!f&&window.opera&&(null===q.body||!q.body.innerHTML)&&
--B){p("requeing onLoad callback, DOM not available");setTimeout(g,250);return}var h=q.body?q.body:q.documentElement;i.responseText=h?h.innerHTML:null;i.responseXML=q.XMLDocument?q.XMLDocument:q;f&&(d.dataType="xml");i.getResponseHeader=function(a){return{"content-type":d.dataType}[a]};h&&(i.status=Number(h.getAttribute("status"))||i.status,i.statusText=h.getAttribute("statusText")||i.statusText);var j=(d.dataType||"").toLowerCase(),l=/(json|script|text)/.test(j);if(l||d.textarea){var k=q.getElementsByTagName("textarea")[0];
if(k)i.responseText=k.value,i.status=Number(k.getAttribute("status"))||i.status,i.statusText=k.getAttribute("statusText")||i.statusText;else if(l){var o=q.getElementsByTagName("pre")[0],w=q.getElementsByTagName("body")[0];o?i.responseText=o.textContent?o.textContent:o.innerText:w&&(i.responseText=w.textContent?w.textContent:w.innerText)}}else"xml"==j&&!i.responseXML&&i.responseText&&(i.responseXML=C(i.responseText));try{u=D(i,j,d)}catch(A){a="parsererror",i.error=e=A||a}}catch(y){p("error caught: ",
y),a="error",i.error=e=y||a}i.aborted&&(p("upload aborted"),a=null);i.status&&(a=200<=i.status&&300>i.status||304===i.status?"success":"error");"success"===a?(d.success&&d.success.call(d.context,u,"success",i),n&&b.event.trigger("ajaxSuccess",[i,d])):a&&(void 0===e&&(e=i.statusText),d.error&&d.error.call(d.context,i,a,e),n&&b.event.trigger("ajaxError",[i,d,e]));n&&b.event.trigger("ajaxComplete",[i,d]);n&&!--b.active&&b.event.trigger("ajaxStop");d.complete&&d.complete.call(d.context,i,a);z=!0;d.timeout&&
clearTimeout(v);setTimeout(function(){d.iframeTarget||r.remove();i.responseXML=null},100)}}}var j=k[0],h,l,d,n,o,r,m,i,s,v;h=!!b.fn.prop;if(c)if(h)for(l=0;l<c.length;l++)h=b(j[c[l].name]),h.prop("disabled",!1);else for(l=0;l<c.length;l++)h=b(j[c[l].name]),h.removeAttr("disabled");if(b(":input[name=submit],:input[id=submit]",j).length)alert('Error: Form elements must not have name or id of "submit".');else if(d=b.extend(!0,{},b.ajaxSettings,a),d.context=d.context||d,o="jqFormIO"+(new Date).getTime(),
d.iframeTarget?(r=b(d.iframeTarget),(h=r.attr("name"))?o=h:r.attr("name",o)):(r=b('<iframe name="'+o+'" src="'+d.iframeSrc+'" />'),r.css({position:"absolute",top:"-1000px",left:"-1000px"})),m=r[0],i={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var c=a==="timeout"?"timeout":"aborted";p("aborting upload... "+c);this.aborted=1;r.attr("src",d.iframeSrc);i.error=
c;d.error&&d.error.call(d.context,i,c,a);n&&b.event.trigger("ajaxError",[i,d,c]);d.complete&&d.complete.call(d.context,i,c)}},(n=d.global)&&0===b.active++&&b.event.trigger("ajaxStart"),n&&b.event.trigger("ajaxSend",[i,d]),d.beforeSend&&!1===d.beforeSend.call(d.context,i,d))d.global&&b.active--;else if(!i.aborted){if(c=j.clk)if((h=c.name)&&!c.disabled)d.extraData=d.extraData||{},d.extraData[h]=c.value,"image"==c.type&&(d.extraData[h+".x"]=j.clk_x,d.extraData[h+".y"]=j.clk_y);var t=1,x=2,c=b("meta[name=csrf-token]").attr("content");
if((h=b("meta[name=csrf-param]").attr("content"))&&c)d.extraData=d.extraData||{},d.extraData[h]=c;d.forceSync?e():setTimeout(e,10);var u,q,B=50,z,C=b.parseXML||function(a,b){if(window.ActiveXObject){b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}else b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&b.documentElement.nodeName!="parsererror"?b:null},E=b.parseJSON||function(a){return window.eval("("+a+")")},D=function(a,c,d){var e=a.getResponseHeader("content-type")||
"",f=c==="xml"||!c&&e.indexOf("xml")>=0,a=f?a.responseXML:a.responseText;f&&a.documentElement.nodeName==="parsererror"&&b.error&&b.error("parsererror");d&&d.dataFilter&&(a=d.dataFilter(a,c));typeof a==="string"&&(c==="json"||!c&&e.indexOf("json")>=0?a=E(a):(c==="script"||!c&&e.indexOf("javascript")>=0)&&b.globalEval(a));return a}}}if(!this.length)return p("ajaxSubmit: skipping submit process - no element selected"),this;var f,e,k=this;"function"==typeof a&&(a={success:a});f=this.attr("method");e=
this.attr("action");(e=(e="string"===typeof e?b.trim(e):"")||window.location.href||"")&&(e=(e.match(/^([^#]+)/)||[])[1]);a=b.extend(!0,{url:e,success:b.ajaxSettings.success,type:f||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);e={};this.trigger("form-pre-serialize",[this,a,e]);if(e.veto)return p("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return p("ajaxSubmit: submit aborted via beforeSerialize callback"),
this;var l=a.traditional;void 0===l&&(l=b.ajaxSettings.traditional);var h,j=this.formToArray(a.semantic);a.data&&(a.extraData=a.data,h=b.param(a.data,l));if(a.beforeSubmit&&!1===a.beforeSubmit(j,this,a))return p("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[j,this,a,e]);if(e.veto)return p("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;e=b.param(j,l);h&&(e=e?e+"&"+h:h);"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?
"&":"?")+e,a.data=null):a.data=e;var n=[];a.resetForm&&n.push(function(){k.resetForm()});a.clearForm&&n.push(function(){k.clearForm(a.includeHidden)});if(!a.dataType&&a.target){var o=a.success||function(){};n.push(function(c){var e=a.replaceTarget?"replaceWith":"html";b(a.target)[e](c).each(o,arguments)})}else a.success&&n.push(a.success);a.success=function(b,c,e){for(var f=a.context||a,g=0,h=n.length;g<h;g++)n[g].apply(f,[b,c,e||k,k])};h=0<b("input:file:enabled[value]",this).length;e="multipart/form-data"==
k.attr("enctype")||"multipart/form-data"==k.attr("encoding");l=t&&u;p("fileAPI :"+l);!1!==a.iframe&&(a.iframe||(h||e)&&!l)?a.closeKeepAlive?b.get(a.closeKeepAlive,function(){g(j)}):g(j):(h||e)&&l?c(j):b.ajax(a);this.trigger("form-submit-notify",[this,a]);return this};b.fn.ajaxForm=function(a){a=a||{};a.delegation=a.delegation&&b.isFunction(b.fn.on);if(!a.delegation&&0===this.length){var c=this.selector,g=this.context;if(!b.isReady&&c)return p("DOM not ready, queuing ajaxForm"),b(function(){b(c,g).ajaxForm(a)}),
this;p("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return a.delegation?(b(document).off("submit.form-plugin",this.selector,o).off("click.form-plugin",this.selector,s).on("submit.form-plugin",this.selector,a,o).on("click.form-plugin",this.selector,a,s),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,o).bind("click.form-plugin",a,s)};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(a){var c=
[];if(0===this.length)return c;var g=this[0],f=a?g.getElementsByTagName("*"):g.elements;if(!f)return c;var e,k,l,h,j,n;e=0;for(n=f.length;e<n;e++)if(j=f[e],l=j.name)if(a&&g.clk&&"image"==j.type)!j.disabled&&g.clk==j&&(c.push({name:l,value:b(j).val(),type:j.type}),c.push({name:l+".x",value:g.clk_x},{name:l+".y",value:g.clk_y}));else if((h=b.fieldValue(j,!0))&&h.constructor==Array){k=0;for(j=h.length;k<j;k++)c.push({name:l,value:h[k]})}else if(t&&"file"==j.type&&!j.disabled){h=j.files;for(k=0;k<h.length;k++)c.push({name:l,
value:h[k],type:j.type})}else null!==h&&"undefined"!=typeof h&&c.push({name:l,value:h,type:j.type});if(!a&&g.clk&&(a=b(g.clk),f=a[0],(l=f.name)&&!f.disabled&&"image"==f.type))c.push({name:l,value:a.val()}),c.push({name:l+".x",value:g.clk_x},{name:l+".y",value:g.clk_y});return c};b.fn.formSerialize=function(a){return b.param(this.formToArray(a))};b.fn.fieldSerialize=function(a){var c=[];this.each(function(){var g=this.name;if(g){var f=b.fieldValue(this,a);if(f&&f.constructor==Array)for(var e=0,k=f.length;e<
k;e++)c.push({name:g,value:f[e]});else null!==f&&"undefined"!=typeof f&&c.push({name:this.name,value:f})}});return b.param(c)};b.fn.fieldValue=function(a){for(var c=[],g=0,f=this.length;g<f;g++){var e=b.fieldValue(this[g],a);null===e||"undefined"==typeof e||e.constructor==Array&&!e.length||(e.constructor==Array?b.merge(c,e):c.push(e))}return c};b.fieldValue=function(a,c){var g=a.name,f=a.type,e=a.tagName.toLowerCase();void 0===c&&(c=!0);if(c&&(!g||a.disabled||"reset"==f||"button"==f||("checkbox"==
f||"radio"==f)&&!a.checked||("submit"==f||"image"==f)&&a.form&&a.form.clk!=a||"select"==e&&-1==a.selectedIndex))return null;if("select"==e){var k=a.selectedIndex;if(0>k)return null;for(var g=[],e=a.options,l=(f="select-one"==f)?k+1:e.length,k=f?k:0;k<l;k++){var h=e[k];if(h.selected){var j=h.value;j||(j=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return j;g.push(j)}}return g}return b(a).val()};b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",
this).clearFields(a)})};b.fn.clearFields=b.fn.clearInputs=function(a){var b=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var g=this.type,f=this.tagName.toLowerCase();b.test(g)||"textarea"==f||a&&/hidden/.test(g)?this.value="":"checkbox"==g||"radio"==g?this.checked=!1:"select"==f&&(this.selectedIndex=-1)})};b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&
this.reset()})};b.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};b.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var c=this.type;"checkbox"==c||"radio"==c?this.checked=a:"option"==this.tagName.toLowerCase()&&(c=b(this).parent("select"),a&&c[0]&&"select-one"==c[0].type&&c.find("option").selected(!1),this.selected=a)})};b.fn.ajaxSubmit.debug=!1})(jQuery);
